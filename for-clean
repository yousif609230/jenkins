import csv
import json
import sys

def convert_csv_to_json(csv_file_path, output_json_path):
    # List to store the data
    data = []
    
    try:
        # Open and read the CSV file
        with open(csv_file_path, 'r') as csv_file:
            # Create CSV reader
            csv_reader = csv.DictReader(csv_file)
            
            # Extract only CIF and email columns for each row
            for row in csv_reader:
                filtered_row = {
                    'cif': row['cif'],
                    'email': row['email']
                }
                data.append(filtered_row)
        
        # Write to JSON file
        with open(output_json_path, 'w') as json_file:
            json.dump(data, json_file, indent=4)
            
        print(f"Successfully converted CSV to JSON. Output saved to {output_json_path}")
        
    except FileNotFoundError:
        print(f"Error: The file {csv_file_path} was not found.")
    except KeyError as e:
        print(f"Error: Column {e} not found in CSV file. Please ensure 'cif' and 'email' columns exist in your CSV.")
    except Exception as e:
        print(f"An error occurred: {str(e)}")

if __name__ == "__main__":
    if len(sys.argv) != 3:
        print("Usage: python csv_to_json_converter.py input.csv output.json")
    else:
        input_csv = sys.argv[1]
        output_json = sys.argv[2]
        convert_csv_to_json(input_csv, output_json)
